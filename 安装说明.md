# Fusion360 批量参数化导出插件 - 安装和使用说明

## 安装方法

### 方法一：通过 Fusion360 插件管理器安装

1. 打开 Fusion360
2. 点击菜单栏的"工具" → "插件和脚本"
3. 在弹出的对话框中，点击"脚本"选项卡
4. 点击"添加"按钮，选择本插件的文件夹
5. 插件会出现在脚本列表中

### 方法二：手动复制到插件目录

1. 找到 Fusion360 的插件目录：
   - **Windows**: `%appdata%\Autodesk\Autodesk Fusion 360\API\Scripts`
   - **Mac**: `~/Library/Application Support/Autodesk/Autodesk Fusion 360/API/Scripts`

2. 将插件文件夹复制到上述目录中

3. 重启 Fusion360

## 文件结构

插件包含以下文件：
```
BatchParametricExport/
├── BatchParametricExport.py        # 主插件文件
├── BatchParametricExport.manifest  # 插件清单（与脚本同名）
├── ExportUtils.py                 # 导出工具模块
├── config.json                    # 配置文件
├── README.md                      # 项目说明
└── 安装说明.md                   # 本文件
```

## 使用方法

### 第一步：准备参数化模型

1. 在 Fusion360 中创建或打开一个参数化模型
2. 在"修改" → "更改参数"中，将需要批量修改的参数设为"收藏"（点击星形图标）
3. 确认所有需要批量导出的参数都已标星

### 第二步：运行插件

1. 在 Fusion360 中，打开"工具" → "插件和脚本"
2. 在"脚本"选项卡中找到"BatchParametricExport"
3. 点击"运行"按钮

### 第三步：配置导出参数

插件界面包含以下部分：

#### 参数配置表格
- **第一列（导出格式）**：支持的格式包括
  - `step` - STEP 格式（推荐用于机械设计）
  - `iges` - IGES 格式（兼容性好）
  - `stl` - STL 格式（3D打印）
  - `obj` - OBJ 格式（3D建模）
  - `3mf` - 3MF 格式（3D打印）

- **第二列（自定义名称）**：必须填写，用于：
  - 创建子文件夹名称
  - 文件名后缀

- **其他列**：显示您标星的参数，可以修改每行的参数值

#### 操作按钮
- **添加新行**：添加新的参数配置组合
- **删除最后行**：删除最后一行配置
- **选择路径**：选择导出文件的目标文件夹

### 第四步：执行批量导出

1. 填写完所有配置后，选择导出路径
2. 点击"确定"开始批量导出
3. 插件会显示进度条，可以随时取消
4. 导出完成后会显示成功消息

## 导出结果

导出的文件会按以下结构组织：

```
选择的导出路径/
├── 自定义名称1/
│   └── 零件名-自定义名称1.step
├── 自定义名称2/
│   └── 零件名-自定义名称2.step
└── 自定义名称3/
    └── 零件名-自定义名称3.iges
```

例如，如果您的零件叫"螺栓"，自定义名称是"M10"，导出格式是"step"，那么导出的文件路径就是：
`/M10/螺栓-M10.step`

## 使用示例

假设您有一个螺栓模型，有两个标星参数：
- `螺栓直径` (当前值: 10mm)
- `螺栓长度` (当前值: 20mm)

您想导出三种规格：

| 导出格式 | 自定义名称 | 螺栓直径 | 螺栓长度 |
|---------|-----------|---------|---------|
| step    | M10x20    | 10      | 20      |
| step    | M12x25    | 12      | 25      |
| step    | M8x15     | 8       | 15      |

导出后会得到：
```
/M10x20/螺栓-M10x20.step
/M12x25/螺栓-M12x25.step
/M8x15/螺栓-M8x15.step
```

## 注意事项

1. **参数必须标星**：只有在参数面板中标记为收藏的参数才会被读取
2. **自定义名称必填**：每行都必须填写自定义名称，否则会提示错误
3. **参数值格式**：参数值支持数值、表达式（如 "10mm"、"d1*2" 等）
4. **模型兼容性**：确保您的模型是完全参数化的，参数变化不会导致错误
5. **文件覆盖**：如果目标文件已存在，会被覆盖
6. **路径权限**：确保您对选择的导出路径有写入权限

## 故障排除

### 常见问题

**Q: 插件无法加载**
A: 检查文件是否完整复制到正确的插件目录，确保 BatchParametricExport.manifest 文件存在且与脚本文件同名

**Q: 找不到标星参数**
A: 在"修改" → "更改参数"中，确认需要的参数已经点击星形图标标记为收藏

**Q: 导出失败**
A: 检查导出路径是否有效，确认模型在参数变化后仍然有效

**Q: 参数应用失败**
A: 检查参数值格式是否正确，确认参数表达式有效

### 获取帮助

如果遇到问题，请：
1. 检查 Fusion360 的文本命令窗口查看错误信息
2. 确认您的 Fusion360 版本支持相关 API
3. 查看插件源码了解具体实现

## 技术信息

- **开发语言**：Python
- **API版本**：Fusion360 API
- **支持平台**：Windows, macOS
- **版本**：1.0.0 