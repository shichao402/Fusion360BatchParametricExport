# Excel 配置管理使用说明

## 概述

Fusion 360 批量参数化导出插件现已支持 Excel 配置管理功能，让您可以更方便地管理批量导出配置。

## 功能特性

✅ **Excel 模板生成** - 自动生成包含所有标星参数的 Excel 模板  
✅ **Excel 配置读取** - 从 Excel 文件读取配置进行批量导出  
✅ **配置验证** - 自动验证配置格式和必要字段  
✅ **用户友好界面** - 简化的 UI 界面，专注于 Excel 配置管理  

## 使用步骤

### 1. 准备工作

1. 在 Fusion 360 中打开您的设计文件
2. 在参数面板中将需要批量修改的参数标星（收藏）
3. 启动批量参数化导出插件

### 2. 设置导出路径

1. 在插件对话框中设置导出路径
2. 点击"🔍 选择路径..."按钮选择文件夹

### 3. 创建 Excel 配置文件

#### 方法一：使用插件生成模板
1. 在"Excel模板路径"中输入文件路径，或留空
2. 点击"📤 导出模板"按钮
3. 如果路径为空，会弹出文件保存对话框
4. 选择保存位置和文件名（建议使用 .xlsx 扩展名）

#### 方法二：手动创建 Excel 文件
1. 创建新的 Excel 文件
2. 第一行添加表头：`导出格式 | 自定义名称 | 参数1 | 参数2 | ...`
3. 从第二行开始添加配置数据

### 4. 编辑 Excel 配置

在生成的 Excel 文件中：

#### 表头说明
- **导出格式**: 支持 step, iges, stl, obj, 3mf
- **自定义名称**: 必填，用于子目录和文件名
- **参数列**: 您的标星参数名称，值为参数表达式

#### 配置示例
| 导出格式 | 自定义名称 | 长度 | 宽度 | 高度 |
|---------|-----------|------|------|------|
| step    | 小零件    | 10mm | 5mm  | 3mm  |
| stl     | 大零件    | 20mm | 10mm | 6mm  |
| iges    | 测试零件  | 15mm | 8mm  | 4mm  |

### 5. 执行批量导出

1. 确保 Excel 文件已保存
2. 在插件中点击"导出"按钮
3. 插件会自动读取 Excel 配置并执行批量导出

## 配置格式说明

### 导出格式
- `step` - STEP 格式（推荐）
- `iges` - IGES 格式
- `stl` - STL 格式
- `obj` - OBJ 格式
- `3mf` - 3MF 格式

### 自定义名称
- 必填字段
- 用于创建子目录和文件名
- 建议使用有意义的名称，如"小零件"、"大零件"等
- 避免使用特殊字符

### 参数值
- 使用 Fusion 360 参数表达式格式
- 支持单位，如 `10mm`、`5cm`、`2in` 等
- 支持数学表达式，如 `10mm + 5mm`
- 支持参数引用，如 `d1`、`d2` 等

## 文件结构

导出后的文件结构：
```
导出路径/
├── 小零件/
│   ├── 小零件.step
│   └── 小零件.f3d
├── 大零件/
│   ├── 大零件.stl
│   └── 大零件.f3d
└── 测试零件/
    ├── 测试零件.iges
    └── 测试零件.f3d
```

## 注意事项

### Excel 文件要求
- 文件格式：.xlsx（推荐）或 .xls
- 第一行必须是表头
- 数据从第二行开始
- 空行会被自动跳过

### 参数要求
- 必须先在 Fusion 360 中将参数标星
- 参数名称必须与 Excel 表头中的名称完全匹配
- 参数值必须是有效的 Fusion 360 表达式

### 导出要求
- 导出路径必须存在且有写入权限
- 自定义名称不能为空
- 至少需要一行有效配置

## 故障排除

### 常见问题

**Q: 插件提示"未找到任何标星参数"**
A: 请确保在 Fusion 360 参数面板中将需要批量修改的参数标星（收藏）

**Q: Excel 文件读取失败**
A: 检查文件路径是否正确，文件是否存在，格式是否为 .xlsx

**Q: 配置验证失败**
A: 检查自定义名称是否为空，参数值是否为有效表达式

**Q: 导出失败**
A: 检查导出路径是否存在且有写入权限，参数值是否有效

### 错误日志

插件会在以下位置生成日志文件：
- 文件：`Fusion360BatchExport.log`
- 位置：插件目录下

## 高级功能

### 备用配置管理
插件保留了原有的 Fusion 360 属性配置管理功能作为备用：
- 点击"💾 保存配置到项目"将 Excel 配置保存到设计文件
- 点击"📂 加载项目配置"从设计文件加载配置到 Excel

### 批量操作
- 可以在 Excel 中一次性配置多个导出任务
- 支持不同格式的混合导出
- 支持参数值的批量修改

## 版本信息

- **openpyxl**: 3.1.5
- **et_xmlfile**: 1.1.0
- **插件版本**: 支持 Excel 配置管理

## 技术支持

如遇到问题，请：
1. 查看错误日志文件
2. 检查 Excel 文件格式
3. 验证参数配置
4. 确认文件路径权限 