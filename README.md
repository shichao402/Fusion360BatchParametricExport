# Fusion360BatchParametricExport
🎯 用于Fusion360参数化批量一键导出的专业插件

## ✨ 核心功能

- **🔄 参数化批量导出**: 读取标星参数，支持多组参数配置
- **📦 每个零件单独导出**: 自动识别子组件，每个零件导出为独立文件
- **📁 智能目录结构**: 每组参数创建独立子目录，文件名包含零件名和参数配置名
- **🎨 多格式支持**: 支持STEP、IGES、STL、OBJ、3MF等主流格式
- **⚡ 可见性控制**: 使用先进的可见性控制技术确保每个零件单独导出
- **📊 Excel配置管理**: 支持Excel文件配置管理，更直观的批量配置方式

## 🚀 使用方法

### 1. 准备工作
- 在Fusion360中打开包含多个零件的设计
- 将需要批量修改的参数设为"收藏"（标星）

### 2. Excel配置管理（推荐）

#### 2.1 生成Excel模板
- 启动插件后，点击"📤 导出模板"按钮
- 选择保存位置，生成包含所有标星参数的Excel模板

#### 2.2 编辑配置
在Excel文件中编辑配置：
| 导出格式 | 自定义名称 | 长度 | 宽度 | 高度 |
|---------|-----------|------|------|------|
| step    | 小零件    | 10mm | 5mm  | 3mm  |
| stl     | 大零件    | 20mm | 10mm | 6mm  |
| iges    | 测试零件  | 15mm | 8mm  | 4mm  |

#### 2.3 执行导出
- 保存Excel文件
- 在插件中点击"导出"按钮
- 插件自动读取Excel配置并执行批量导出

### 3. 传统配置方式（备用）
- **导出格式**: step, iges, stl, obj, 3mf
- **自定义名称**: 必填，用于创建子目录和文件后缀
- **参数值**: 为每组配置设置不同的参数值

### 4. 导出结果
```
导出目录/
├── 小零件/
│   ├── 小零件.step
│   ├── 小零件.f3d
│   └── 其他零件.step
├── 大零件/
│   ├── 大零件.stl
│   ├── 大零件.f3d
│   └── 其他零件.stl
└── 测试零件/
    ├── 测试零件.iges
    ├── 测试零件.f3d
    └── 其他零件.iges
```

## 🔧 技术特点

- **智能组件识别**: 自动检测设计中的所有零件组件
- **可见性控制导出**: 通过控制组件可见性实现单个零件导出
- **参数自动恢复**: 导出完成后自动恢复原始参数值
- **错误处理机制**: 完善的错误处理和进度提示
- **文件名清理**: 自动处理特殊字符，确保文件名兼容性
- **Excel集成**: 集成openpyxl库，支持Excel文件读写
- **配置验证**: 自动验证Excel配置格式和必要字段

## 📋 配置格式说明

### 导出格式
- `step` - STEP格式（推荐，兼容性最好）
- `iges` - IGES格式
- `stl` - STL格式（3D打印常用）
- `obj` - OBJ格式
- `3mf` - 3MF格式

### 参数值格式
- 支持单位：`10mm`、`5cm`、`2in`等
- 支持数学表达式：`10mm + 5mm`
- 支持参数引用：`d1`、`d2`等

## 📖 详细文档

- [Excel配置管理使用说明](Excel配置管理使用说明.md) - 详细的Excel配置管理指南
- [安装说明](安装说明.md) - 插件安装和配置指南

## 🔧 系统要求

- Fusion 360 2023或更高版本
- Windows 10/11
- 支持的设计文件格式：.f3d

## 📝 更新日志

### v2.0.0 - Excel配置管理
- ✅ 新增Excel配置管理功能
- ✅ 集成openpyxl 3.1.5库
- ✅ 简化UI界面，移除动态配置表格
- ✅ 支持Excel模板生成和配置读取
- ✅ 保留传统配置方式作为备用功能

### v1.0.0 - 基础功能
- ✅ 参数化批量导出
- ✅ 多格式支持
- ✅ 智能目录结构
- ✅ 可见性控制导出

## 🤝 贡献

欢迎提交Issue和Pull Request来改进这个插件！

## 📄 许可证

本项目采用MIT许可证 - 查看[LICENSE](LICENSE)文件了解详情。